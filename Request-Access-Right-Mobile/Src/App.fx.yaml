App As appinfo:
    BackEnabled: =false
    ConfirmExit: =true
    MinScreenHeight: =320
    MinScreenWidth: =320
    OnStart: |-
        =If(
            !IsBlank(Acceleration.X),
            Launch("ms-apps:///providers/Microsoft.PowerApps/apps/7487cbe6-b4c6-4674-902a-c100353f7044"),
            Launch("https://apps.powerapps.com/play/e/aafbded5-2635-e4ae-a5d7-aa27ed798f8b/a/dd71c6c2-f9bd-47d1-a9d3-cfaf1c2da60e?tenantId=788a39cf-8ee1-43f8-87ed-0c9b40249af3&hint=4054a7b6-6181-4718-ba3f-20ed328f2d7e&sourcetime=1698373386603")
        );
        If(
            !IsBlank(
                LookUp(
                    LevelApproveTest,
                    IdUser.Email = User().Email && Level.Value = "Approver 1" || IdUser.Email = User().Email && Level.Value = "Approver 2" || IdUser.Email = User().Email && Level.Value = "Approver 3"
                )
            ),
            Set(
                visibleBtnApprover,
                true
            ),
            Set(
                visibleBtnApprover,
                false
            )
        );
        If(
            Office365Users.MyProfile().Department <> "DTS" && IsMatch(
                Office365Users.MyProfile().JobTitle,
                "Head of",
                MatchOptions.Contains
            ),
            Set(
                visibleBtnHOD,
                true
            ),
            Set(
                visibleBtnHOD,
                false
            )
        );
        ClearCollect(
            CollectRequestAll,
            Filter(
                Request_Test,
                'Created By'.Email = User().Email
            )
        );
        ClearCollect(
            CollectRequestNew,
            Filter(
                Request_Test,
                Status.Value = "Created" && 'Created By'.Email = User().Email
            )
        );
        ClearCollect(
            CollectRequestProcess,
            Filter(
                Request_Test,
                (Status.Value = "Created" || Status.Value = "HOD approved" || Status.Value = "Approver 1 approved" || Status.Value = "Approver 2 approved") && 'Created By'.Email = User().Email
            )
        );
        ClearCollect(
            CollectRequestClosed,
            Filter(
                Request_Test,
                Status.Value = "Done" && 'Created By'.Email = User().Email
            )
        );
        ClearCollect(
            CollectRequestRejected,
            Filter(
                Request_Test,
                Status.Value = "Rejected" && 'Created By'.Email = User().Email
            )
        );
        ClearCollect(
            CollectRequestApprover1,
            Filter(
                Request_Test,
                Status.Value = "Created" && User().Email = 'Approver 1'.Email || Status.Value = "HOD approved" && User().Email = 'Approver 1'.Email
            )
        );
        ClearCollect(
            CollectRequestApprover2,
            Filter(
                Request_Test,
                Status.Value = "Approver 1 approved"
            )
        );
        ClearCollect(
            CollectRequestApprover3,
            Filter(
                Request_Test,
                Status.Value = "Approver 2 approved" && 'ReqType: ID'.Value = "2"
            )
        );
        ClearCollect(
            CollectRequestHOD,
            Filter(
                Request_Test,
                Status.Value = "Created" && HOD.Email = User().Email
            )
        );
        ClearCollect(
            CollecRequestHistory_Approver1,
            Filter(
                Request_Test,
                User().Email = 'Approver 1'.Email && 'Approved Date 1' <> Blank() || User().Email = 'Rejected By'.Email && 'Rejected Date' <> Blank()
            )
        );
        ClearCollect(
            CollecRequestHistory_Approver2,
            Filter(
                Request_Test,
                User().Email = 'Approver 2'.Email && 'Approved Date 2' <> Blank() || User().Email = 'Rejected By'.Email && 'Rejected Date' <> Blank()
            )
        );
        ClearCollect(
            CollecRequestHistory_Approver3,
            Filter(
                Request_Test,
                User().Email = 'Approver 3'.Email && 'Approved Date 3' <> Blank() && 'ReqType: ID'.Value = "2" || User().Email = 'Rejected By'.Email && 'Rejected Date' <> Blank()
            )
        );
        ClearCollect(
            CollecRequestHistory_HOD,
            Filter(
                Request_Test,
                User().Email = HOD.Email && 'HOD Approved Date' <> Blank() || User().Email = 'Rejected By'.Email && 'Rejected Date' <> Blank()
            )
        )
    StartScreen: =
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

